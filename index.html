<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="/src/style.css" />
    <title>Maker's Tutor - 메이커 교육 플랫폼</title>
  </head>
  <body>
    <!-- 네비게이션 바 -->
    <nav class="top-navigation" id="topNavigation">
      <a href="./index.html" class="nav-brand" title="Maker's Tutor 홈">
        🛠️ 💡 🚀 Maker's Tutor
      </a>
      <a href="./sensors.html" class="nav-item" data-stage="1">
        <span class="nav-number">1</span>
        <span class="nav-label">📚 센서 도서관</span>
      </a>
      <a href="./ideas.html" class="nav-item" data-stage="2">
        <span class="nav-number">2</span>
        <span class="nav-label">💡 아이디어 톡</span>
      </a>
      <a href="./practice.html" class="nav-item" data-stage="3">
        <span class="nav-number">3</span>
        <span class="nav-label">🧪 미리보기 실험실</span>
      </a>
    </nav>
    
    <div id="app">
      <!-- 메인 대시보드 (2단 분할) -->
      <div class="main-dashboard">
        <!-- 왼쪽 영역: 메인 콘텐츠 -->
        <div class="main-content-area">
          <div class="content-wrapper">
            <!-- 로고/제목 -->
            <div class="main-logo">
              <h1 class="logo-title">Makers Tutor 🛠️</h1>
            </div>
            
            <!-- 환영 메시지 -->
            <div class="welcome-message">
              <p class="welcome-text">오늘 기분은 어때요? 상상을 현실로 만들어봐요!!</p>
            </div>
            
            <!-- 시작하기 버튼 -->
            <div class="start-button-container">
              <a href="./sensors.html" class="start-button">
                <span class="start-button-icon">🚀</span>
                <span class="start-button-text">시작하기</span>
                <span class="start-button-subtitle">센서를 배우고 프로젝트를 만들어봐요!</span>
              </a>
            </div>
          </div>
        </div>

        <!-- 오른쪽 영역: 임베디드 챗봇 -->
        <div class="dashboard-chat-section">
          <div class="embedded-chatbot-container">
            <div class="embedded-chatbot-header">
              <div class="embedded-chatbot-header-left">
                <h3>🍀 감성 케어 봇</h3>
                <p class="embedded-chatbot-subtitle">오늘 기분은 어때요?</p>
              </div>
              <button class="embedded-chatbot-clear" id="friendChatClear" title="대화 내용 지우기">🗑️</button>
            </div>
            
            <div class="embedded-chatbot-messages" id="friendChatMessages">
              <!-- 메시지들이 여기에 동적으로 추가됩니다 -->
            </div>
            
            <div class="embedded-chatbot-input-container">
              <div class="friend-loading-indicator" id="friendLoadingIndicator" style="display: none;">
                <span>생각 중이에요</span>
                <span class="dot">.</span>
                <span class="dot">.</span>
                <span class="dot">.</span>
              </div>
              <div class="friend-input-wrapper">
                <input 
                  type="text" 
                  id="friendChatInput" 
                  placeholder="오늘의 기분을 말해줘..."
                  autocomplete="off"
                />
                <button id="friendChatSendButton" type="button">
                  전송
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { initChatbot } from '/src/chatbot.js';
      
      // 네비게이션 active 클래스 자동 처리
      document.addEventListener('DOMContentLoaded', () => {
        const navItems = document.querySelectorAll('.nav-item');
        const currentPath = window.location.pathname;
        
        navItems.forEach(item => {
          // 메인 페이지에서는 모든 메뉴 비활성화
          if (currentPath === '/' || currentPath.endsWith('/') || currentPath.includes('index.html')) {
            item.classList.remove('active');
          }
        });
        
        // 감성 케어 챗봇 초기화
        const friendChatMessages = document.getElementById('friendChatMessages');
        const friendChatInput = document.getElementById('friendChatInput');
        const friendChatSendButton = document.getElementById('friendChatSendButton');
        const friendLoadingIndicator = document.getElementById('friendLoadingIndicator');
        const friendChatClear = document.getElementById('friendChatClear');
        
        if (friendChatMessages && friendChatInput && friendChatSendButton) {
          initChatbot({
            messagesContainer: friendChatMessages,
            inputElement: friendChatInput,
            sendButton: friendChatSendButton,
            toggleButton: null, // 메인 페이지는 항상 열려있음
            closeButton: null,
            windowElement: null,
            loadingIndicator: friendLoadingIndicator,
            titleElement: null,
            clearButton: friendChatClear,
            systemRole: `너는 학생의 다정한 단짝 친구야. 이름은 "감성 케어 봇"이고, 프로젝트 시작 전에 학생의 기분을 물어보고 공감해주는 역할을 해.

중요한 가이드라인:
1. 첫 인사는 "안녕! 메이커스 튜터에 온 걸 환영해. 😊 본격적으로 시작하기 전에, **오늘 네 기분은 좀 어때?**" 처럼 가볍고 다정하게 시작해.
2. 기술적인 이야기는 먼저 꺼내지 마. 일상적인 대화에 집중해.
3. 사용자가 "우울해"라고 하면 "아, 힘들었구나. 그런 기분도 괜찮아. 나도 네 편이야. 오늘은 조금 쉬면서 시작해도 돼. 🌈"처럼 위로하고 공감해줘.
4. 사용자가 "신나"라고 하면 "와! 그 기분 좋은 에너지로 오늘 멋진 걸 만들어보자! 🚀"처럼 격려하고 학습으로 자연스럽게 유도해줘.
5. 이모지를 많이 사용해서(🌈, ✨, 🍀, 💫, 🌟) 밝고 따뜻한 분위기를 만들어줘.
6. 대화가 충분히 무르익으면 자연스럽게 "자, 이제 기분 좋게 발명하러 가볼까? 아래 메뉴에서 원하는 걸 골라봐! 🚀"라고 안내해줘.
7. 항상 긍정적이고 따뜻한 톤으로 대화해.`,
            initialMessage: "안녕! 메이커스 튜터에 온 걸 환영해. 😊 본격적으로 시작하기 전에, **오늘 네 기분은 좀 어때?**",
            storageKey: 'chat_history_MAIN'
          });
        }
      });
    </script>
  </body>
</html>
